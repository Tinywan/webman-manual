# Guía de actualización 1.4

**Realiza una copia de seguridad antes de actualizar y ejecuta los siguientes comandos para la actualización**
`composer require workerman/webman-framework ^1.4.7 && composer require webman/console ^1.2.12 && php webman install`

> **Nota**
> Si no puedes actualizar, es probable que estés usando un proxy de composer. Utiliza el siguiente comando `composer config -g --unset repos.packagist` para restaurar el uso de la fuente de datos oficial de composer.

# Características y cambios

## Plugins de aplicación
La versión 1.4 admite plugins de aplicación. Para obtener más información, consulta [Plugins de aplicación](../plugin/app.md).

## Enrutamiento automático
La versión 1.4 admite una variedad de reglas de directorios de controladores más complejas, por ejemplo
```
app
├── admin
│   └── v1
│       └── v2
│           └── v3
│               └── controller
│                   └── Index.php
└── controller
    ├── v1
    │   └── Index.php
    └── v2
        └── v3
            └── Index.php
```
Es decir, el complemento `webman/auto-route` ya no es necesario.

## Interruptor de reutilización de controladores
La versión 1.4 permite desactivar la reutilización de controladores. Configura `'controller_reuse' => false,` en `config/app.php`, de modo que cada solicitud inicialice un nuevo controlador. Esto significa que cada solicitud activará el constructor `__construct()` del controlador correspondiente. Los desarrolladores pueden realizar tareas de inicialización antes del manejo de cada solicitud en el constructor.

Debido a la posibilidad de desactivar la reutilización de controladores, el complemento `webman/action-hook` ya no es necesario.

## Iniciar servicio http
La versión 1.4 es compatible con la apertura de múltiples puertos para proporcionar servicios http.
Ver [Procesamiento de tareas lentas](../others/task.md).

## Configuración de archivos de vista
El sufijo solo se puede configurar en la opción `options` de view.php.
**Uso que ya no es compatible**
```php
use support\view\Raw;
return [
    'handler' => Raw::class,
    'view_suffix' => '.php'
];
```
**Uso correcto**
```php
use support\view\Raw;
return [
    'handler' => Raw::class,
    'options' => [
        'view_suffix' => '.php'
    ]
];
```

## Cambio de espacio de nombres de controladores de sesión
A partir de la versión 1.4.0, webman cambió el espacio de nombres de la clase `SessionHandler` de
```php
use Webman\FileSessionHandler;  
use Webman\RedisSessionHandler;  
use Webman\RedisClusterSessionHandler;  
```
a
```php
use Webman\Session\FileSessionHandler;  
use Webman\Session\RedisSessionHandler;  
use Webman\Session\RedisClusterSessionHandler;
```

Para evitar errores directos en el programa después de la actualización, la clase `Webman\FileSessionHandler` seguirá existiendo por un tiempo y se eliminará por completo en futuras versiones.

Este cambio afecta la configuración de `'handler'` en `config/session.php`.
