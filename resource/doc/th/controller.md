# คอนโทรลเลอร์

สร้างไฟล์คอนโทรลเลอร์ใหม่ `app/controller/FooController.php`。

```php
<?php
namespace app\controller;

use support\Request;

class FooController
{
    public function index(Request $request)
    {
        return response('hello index');
    }
    
    public function hello(Request $request)
    {
        return response('hello webman');
    }
}
```

เมื่อเข้าไปที่ `http://127.0.0.1:8787/foo` จะแสดงผลเป็น `hello index`。

เมื่อเข้าไปที่ `http://127.0.0.1:8787/foo/hello` จะแสดงผลเป็น `hello webman`。

แน่นอนว่าคุณสามารถเปลี่ยนแปลงกฎเส้นทางโดยการกำหนดค่าในการกำหนดเส้นทาง ดูเพิ่มเติมที่[เส้นทาง](route.md)。

> **เคล็ดลับ**
> หากพบว่ามีข้อผิดพลาด 404 ที่ไม่สามารถเข้าถึงได้ โปรดเปิด `config/app.php` และตั้งค่า `controller_suffix` เป็น `Controller` และรีสตาร์ท.

## รายละเอียดของคอนโทรเลอร์
webman ตั้งแต่เวอร์ชัน 1.3 เป็นต้นมา สนับสนุนในการตั้งค่าคำนำหน้าของคอนโทรลเลอร์ ถ้า `config/app.php` กำหนดคำนำหน้าเป็นว่างเปล่า `''` คอนโทรลเลอร์จะมีลักษณะดังนี้

`app\controller\Foo.php`。

```php
<?php
namespace app\controller;

use support\Request;

class Foo
{
    public function index(Request $request)
    {
        return response('hello index');
    }
    
    public function hello(Request $request)
    {
        return response('hello webman');
    }
}
```

ขอแนะนำให้กำหนดคำนำหน้าของคอนโทรลเลอร์เป็น `Controller` เพื่อป้องกันคอนโทรลเลอร์ซ้อนทับกับชื่อคลาสของโมเดล และยังเพิ่มความปลอดภัยได้ด้วย

## คำสั่งอธิบาย
 - โครงงานจะส่งวัตถุ `support\Request` ไปยังคอนโทรเลอร์โดยอัตโนมัติ สามารถใช้งานข้อมูลที่ผู้ใช้กรอกเข้ามาได้ (get post header cookie และข้อมูลอื่น ๆ) ดูเพิ่มเติมที่[คำขอ](request.md)
 - คอนโทรเลอร์สามารถส่งตัวเลข ข้อความ หรือวัตถุ `support\Response` แต่ไม่สามารถส่งประเภทของข้อมูลอื่น ๆ ได้
 - วัตถุ `support\Response` สามารถสร้างผ่านการใช้ฟังก์ชัน helper เช่น `response()` `json()` `xml()` `jsonp()` `redirect()` เป็นต้น

## ชีวิตของคอนโทรเลอร์

เมื่อ `config/app.php` กำหนด `controller_reuse` เป็น `false` ทุกคำขอจะสร้างโอกาสของตัวเลอร์คอนโทรเลอร์ที่สอดคล้อง ทุกคำขอสิ้นสุดตัวเลอร์คอนโทรเลอร์จะถูกทำลายต่อหนึ่งจากนั้น ซึ่งคล้ายกับกับการทำงานของโครงสร้าง传统一般

เมื่อ `config/app.php` กำหนด `controller_reuse` เป็น `true` ทุกคำขอจะสร้างโอกาสของตัวเลอร์คอนโทรเลอร์ที่สอดคล้อง ทุกคำขอที่เหลือจะสร้างโอกาสของตัวเลอร์คอนโทรเลอร์ที่สอดคล้อง ตัวเลอร์คอนโทรเลอร์จะยังมีอยู่หลังจากการสิ้นสุดคำขอ ทุกคำขอถัดไปสามารถใช้ตัวเลอร์คอนโทรเลอร์ให้ใช้ซ้ำ

> **โปรดทราบ**
> การปิดตัวเลอร์เก็บเกี่ยวกับคอนโทรเลอร์ต้องwebman >= 1.4.0 ก่อนทั้ง ที่เหมาะสมกับ 1.4.0 ก่อนจะเป็นคอนโทรเลอร์ที่กำหนดถิ่นทั่วไป จะไม่สามารถเปลี่ยนแปลง

> **โปรดทราบ**
> เมื่อคุณเปิดตัวเลอร์นี้ คำขอจะไม่สามารถเปลี่ยนแปลงคุณสมบัติของตัวเลอร์นั่น โดยเฉพาะแก้ไขคุณสมบัติผลกระทบต่อการสิ้นสุดของการเลี้ยง ซึ่งเป็นตัวอย่างดังนี้

```php
<?php
namespace app\controller;

use support\Request;

class FooController
{
    protected $model;
    
    public function update(Request $request, $id)
    {
        $model = $this->getModel($id);
        $model->update();
        return response('ok');
    }
    
    public function delete(Request $request, $id)
    {
        $model = $this->getModel($id);
        $model->delete();
        return response('ok');
    }
    
    protected function getModel($id)
    {
        // ช่วงเวลานี้ของвометации се из остаток
        // jika кемудиано восроим у интервал то
        if (!$this->model) {
            $this->model = Model::find($id);
        }
        return $this->model;
    }
}
```

> **เคล็ดลับ**
> ในคอนโทรเลอร์ที่กำหนดถิ่นทั่วไป __construct ไม่สามารถให้ผลต่อการสิ้นสุดของคำขอ, ตัวอย่างเช่น

```php
<?php
namespace app\controller;

use support\Request;

class FooController
{
    public function __construct()
    {
        // ไม่สามารถส่งผลต่อการสิ้นสุดของคำขอ บราวเซอร์จะไม่ได้รับการตอบสนองนี้
        return response('hello'); 
    }
}
```

## คำสั่งอธิบายระหว่างไม่เก็บคอนโทรเลอร์และการเก็บคอนโทรเลอร์

ความแตกต่าง ดังนี้

#### ไม่เก็บคอนโทรเลอร์
ทุกคำขอจะสร้างคำขอของคอนโทรเลอร์อันใหม่ทุกครั้ง หลังจากนั้นคำขอจะทำการล้ของตัวเลอร์คอนโทรเลอร์ทันทีหลังจากนั้นจึงนำออก หรือเก็บหน่วยความจำ การล้ของคำขอสร้างการล้ชะงังนั้นพันธกิจความรุนแรงยังสามารถลableOpacityถึง 10% กระนั้นการนำเอาผู้แบบแรกศักดิ์แรงในระดับสูง

#### เก็บคอนโทรเลอร์
การทำยับยั้งกระต่ายการสร้างของคอนโทรเลอร์รายการเดียวกับitechplusafiบยุติกระพืนห่หเหตุินก้องแูบด 

#### กรณีสามารถสามารถไม่สามารถใช้การเอก็บคอนโทรเลอร์ 
เมื่อคำขอที่จะสามารถเอ็บทระเบำตารทร่นของคอนโทรลเลอร์  จะไม่สามารถกำหนดตัวเลอร์ประภัสสมถานการเปลี่ยนของคำขอถ้าอความถาเปลี่ยงนี่การเปลี่ยงแล้งองจะจ้องึงห่ยงอี้ซ็งค่ึงวตองปอ้คิงตวงนคูยารตคใดโตำขททูตย โดยาึ่พีืสหสับสสส่งบีทมท็ท7/uู่สทิำดตาทผทื่มูทำตหทีลบ้ดลสสดูี่จาีทตีืมด็ี่รดอสรีดเสลดี่เ่ หิาาด้า ดดด่สดาบ่าดส์็ด่สยะูด่าดสวลดคาพสส่ืบผู้แบบะ็ง็ู่ี่ Solelyขขารคบูได่างท


