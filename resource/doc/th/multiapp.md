# แอปพลิเคชันหลายรายการ
บางครั้งโปรเจกต์หนึ่งอาจถูกแยกออกเป็นหลายโปรเจกต์ย่อย เช่น ร้านค้าอาจถูกแยกเป็นโปรเจกต์ย่อย 3 รายการ ได้แก่ โปรเจกต์หลักของร้านค้า อินเตอร์เฟซ api ของร้านค้า และหน้าหลังบ้านของร้านค้า โดยทั้ง 3 รายการนี้ใช้การกำหนดฐานข้อมูลเดียวกัน

webman ช่วยให้คุณสามารถวางตำแหน่ง app ได้ดังนี้:
```
app
├── shop
│   ├── controller
│   ├── model
│   └── view
├── api
│   ├── controller
│   └── model
└── admin
    ├── controller
    ├── model
    └── view
```
เมื่อเข้าถึง URL  `http://127.0.0.1:8787/shop/{คอนโทรลเลอร์}/{วิธีการ}` จะเข้าถึงคอนโทรลเลอร์และวิธีการที่อยู่ภายใต้ `app/shop/controller` 

เมื่อเข้าถึง URL  `http://127.0.0.1:8787/api/{คอนโทรลเลอร์}/{วิธีการ}` จะเข้าถึงคอนโทรลเลอร์และวิธีการที่อยู่ภายใต้ `app/api/controller` 

เมื่อเข้าถึง URL  `http://127.0.0.1:8787/admin/{คอนโทรลเลอร์}/{วิธีการ}` จะเข้าถึงคอนโทรลเลอร์และวิธีการที่อยู่ภายใต้ `app/admin/controller` 

ใน webman คุณสามารถวางตำแหน่ง app ได้ดังนี้ 
```
app
├── controller
├── model
├── view
│
├── api
│   ├── controller
│   └── model
└── admin
    ├── controller
    ├── model
    └── view
```
ดังนั้นเมื่อเข้าถึง URL `http://127.0.0.1:8787/{คอนโทรลเลอร์}/{วิธีการ}` จะเข้าถึงคอนโทรลเลอร์และวิธีการที่อยู่ภายใต้ `app/controller` โดยเมื่อพาธของแอปพลิเคชันขึ้นต้นด้วย api หรือ admin จะเข้าถึงคอนโทรลเลอร์และวิธีการที่อยู่ภายในไดเรกทอรีที่เกี่ยวข้อง

สำหรับการเว้นระหว่างคลาสในแอปพลิเคชันหลายรายการจำเป็นต้องเป็นไปตาม `psr4` เช่น ไฟล์ `app/api/controller/FooController.php` จะมีคลาสตัวอย่างดังนี้:
```php
<?php
namespace app\api\controller;

use support\Request;

class FooController
{
    
}
```

## การกำหนดมิดเดิลแวร์ในแอปพลิเคชันหลายรายการ
บางครั้งคุณอาจต้องการกำหนดมิดเดิลแวร์ที่แตกต่างกันสำหรับแต่ละแอปพลิเคชัน เช่น แอปพลิเคชัน `api` อาจต้องการมิดเดิลแวร์ที่เปิดใช้งาน跨โดเมน และ `admin` อาจต้องการมิดเดิลแวร์ที่ตรวจสอบการเข้าสู่ระบบของผู้ดูแลระบบ ดังนี้คุณอาจจะกำหนดมิดเดิลแวร์ใน `config/midlleware.php` ได้ดังต่อไปนี้:
```php
return [
    // มิดเดิลแวร์ทั่วไป
    '' => [
        support\middleware\AuthCheck::class,
    ],
    // มิดเดิลแวร์ของแอปพลิเคชัน api
    'api' => [
         support\middleware\AccessControl::class,
     ],
    // มิดเดิลแวร์ของแอปพลิเคชัน admin
    'admin' => [
         support\middleware\AdminAuthCheck::class,
         support\middleware\SomeOtherClass::class,
    ],
];
```
> มิดเดิลแวร์ที่กล่าวถึงอาจจะไม่มีอยู่จริง โดยที่ที่นี่มีไว้เพียงเพื่อแสดงตัวอย่างถึงวิธีการกำหนดมิดเดิลแวร์ตามแอปพลิเคชัน

ลำดับการทำงานของมิดเดิลแวร์คือ `มิดเดิลแวร์ทั่วไป` -> `มิดเดิลแวร์ของแอปพลิเคชัน` 

สำหรับการพัฒนามิดเดิลแวร์ โปรดอ้างอิงที่[บทที่เกี่ยวกับมิดเดิลแวร์](middleware.md)

## การกำหนดการจัดการข้อยกเว้นในแอปพลิเคชันหลายรายการ
เช่นเดียวกับนั้น คุณอาจต้องการกำหนดคลาสการจัดการข้อยกเว้นที่แตกต่างกันสำหรับแต่ละแอปพลิเคชัน เช่น การจัดการข้อยกเว้นในแอปพลิเคชัน `shop` เมื่อเกิดข้อยกเว้นคุณอาจต้องการแสดงหน้าเพจแจ้งข้อมูลผู้ใช้อย่างเป็นมิตร และในแอปพลิเคชัน `api` เมื่อเกิดข้อยกเว้นคุณอาจต้องการส่งกลับเป็นสตริง json นั่นคือวิธีการกำหนดการจัดการข้อยกเว้นที่แตกต่างต่อแต่ละแอปพลิเคชันดังนี้ ในไฟล์การกำหนดการจัดการข้อยกเว้น `config/exception.php` อาจจะดูเป็นตามนี้:
```php
return [
    'shop' => support\exception\Handler::class,
    'api' => support\exception\ApiHandler::class,
];
```
> ในขณะที่การจัดการข้อยกเว้นคลาสอาจจะไม่มีอยู่จริง ที่นี่มีไว้เพียงเพื่อแสดงตัวอย่างถึงวิธีการกำหนดการจัดการข้อยกเว้นตามแอปพลิเคชัน

การพัฒนาการจัดการข้อยกเว้น โปรดอ้างอิงที่ [บทที่เกี่ยวกับการจัดการข้อยกเว้น](exception.md)
