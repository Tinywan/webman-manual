# Процесс выполнения

## Процесс запуска процесса

После выполнения команды php start.php start процесс выполнения следующий:

1. Загрузка конфигурации из каталога config/
2. Установка связанных с Worker параметров, таких как `pid_file`, `stdout_file`, `log_file`, `max_package_size`
3. Создание процесса webman и прослушивание порта (по умолчанию 8787)
4. Создание пользовательского процесса в соответствии с конфигурацией
5. После запуска процесса webman и пользовательского процесса выполняются следующие логические шаги(все это происходит внутри onWorkerStart):
   ① Загрузка файлов, установленных в файле `config/autoload.php`, таких как `app/functions.php`
   ② Загрузка установленных в файле `config/middleware.php` (включая `config/plugin/*/*/middleware.php`) промежуточных обработчиков
   ③ Выполнение установленных в файле `config/bootstrap.php` (включая `config/plugin/*/*/bootstrap.php`) методов класса start для инициализации модулей, например, инициализация соединения с базой данных Laravel
   ④ Загрузка установленных в файле `config/route.php` (включая `config/plugin/*/*/route.php`) определенных маршрутов

## Процесс обработки запроса
1. Проверка соответствия запрашиваемого URL статическому файлу в каталоге public; если да, то возвращается файл (завершение запроса), если нет, то выполняется шаг 2
2. В зависимости от URL проверяется, есть ли совпадение с каким-либо маршрутом; если совпадения нет, то выполняется шаг 3, если совпадение есть, то выполняется шаг 4
3. Проверяется, отключены ли стандартные маршруты; если да, то возвращается код 404 (завершение запроса), если нет, то выполняется шаг 4
4. Находится промежуточный обработчик, соответствующий запрашиваемому контроллеру, выполняются действия промежуточных обработчиков в указанном порядке (этап запроса модели луковицы), выполняется бизнес-логика контроллера, выполняются действия промежуточных обработчиков после выполнения бизнес-логики (этап ответа модели луковицы), запрос завершается. (См. [Модель луковицы для промежуточных обработчиков](https://www.workerman.net/doc/webman/middleware.html#%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%B4%8B%E8%91%B1%E6%A8%A1%E5%9E%8B))
