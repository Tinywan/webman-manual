# Инструмент миграции базы данных Phinx

## Описание

Phinx позволяет разработчикам легко изменять и поддерживать базы данных. Он избегает ручного написания SQL запросов и использует мощный API на PHP для управления миграцией баз данных. Разработчики могут использовать контроль версий для управления своими миграциями баз данных. Phinx позволяет легко мигрировать данные между различными базами данных. Он также может отслеживать, какие миграционные скрипты были выполнены, что позволяет разработчикам больше не беспокоиться о состоянии базы данных и сосредотачиваться на написании более качественных систем.

## Адрес проекта

https://github.com/cakephp/phinx

## Установка

```php
composer require robmorgan/phinx
```

## Официальная документация на китайском

Дополнительную информацию можно найти в официальной китайской документации, здесь приведено только описание того, как использовать в webman.

https://tsy12321.gitbooks.io/phinx-doc/content/

## Структура каталога миграционных файлов

```
.
├── app                        // Каталог приложений
│   ├── controller             // Каталог контроллеров
│   │   └── Index.php          // Контроллер
│   ├── model                  // Каталог моделей
......
├── database                   // Файлы базы данных
│   ├── migrations             // Файлы миграции
│   │   └── 20180426073606_create_user_table.php
│   ├── seeds                  // Тестовые данные
│   │   └── UserSeeder.php
......
```

## Конфигурация phinx.php

Создайте файл phinx.php в корневом каталоге проекта

```php
<?php
return [
    "paths" => [
        "migrations" => "database/migrations",
        "seeds"      => "database/seeds"
    ],
    "environments" => [
        "default_migration_table" => "phinxlog",
        "default_database"        => "dev",
        "default_environment"     => "dev",
        "dev" => [
            "adapter" => "DB_CONNECTION",
            "host"    => "DB_HOST",
            "name"    => "DB_DATABASE",
            "user"    => "DB_USERNAME",
            "pass"    => "DB_PASSWORD",
            "port"    => "DB_PORT",
            "charset" => "utf8"
        ]
    ]
];
```

## Рекомендации по использованию

После объединения кода миграционные файлы больше не подлежат изменению, и в случае проблем необходимо создать новый файл для изменения или удаления операций.

#### Правила именования файлов для создания таблиц

`{время (автоматически создано)}_create_{имя таблицы на английском в нижнем регистре}`

#### Правила именования файлов для изменения таблиц

`{время (автоматически создано)}_modify_{имя таблицы на английском в нижнем регистре+конкретный элемент изменения на английском в нижнем регистре}`

#### Правила именования файлов для удаления таблиц

`{время (автоматически создано)}_delete_{имя таблицы на английском в нижнем регистре+конкретный элемент изменения на английском в нижнем регистре}`

#### Правила именования файлов для заполнения данных

`{время (автоматически создано)}_fill_{имя таблицы на английском в нижнем регистре+конкретный элемент изменения на английском в нижнем регистре}`

