# Guia de atualização 1.4

**Faça backup antes de atualizar, execute os seguintes comandos para atualizar**
`composer require workerman/webman-framework ^1.4.7 && composer require webman/console ^1.2.12 && php webman install`

> **Nota**
> Se não for possível atualizar, provavelmente é devido ao uso de um proxy do composer, use o seguinte comando `composer config -g --unset repos.packagist` para restaurar o uso da fonte de dados oficial do composer

# Características e Mudanças

## Plugins de Aplicação
A versão 1.4 suporta plugins de aplicação, para mais informações, consulte [Plugin de Aplicação](../plugin/app.md)

## Rota Automática
A versão 1.4 suporta diversas regras complexas de diretório de controladores, por exemplo
```
app
├── admin
│   └── v1
│       └── v2
│           └── v3
│               └── controller
│                   └── Index.php
└── controller
    ├── v1
    │   └── Index.php
    └── v2
        └── v3
            └── Index.php
```
Em outras palavras, o plugin `webman/auto-route` não é mais necessário

## Interruptor de Reutilização de Controlador
A versão 1.4 permite desativar a reutilização do controlador, definindo `'controller_reuse' => false,` no `config/app.php`. Isso significa que cada solicitação irá inicializar um novo controlador, ou seja, cada solicitação irá acionar a função construtora `__construct()` correspondente ao controlador. Os desenvolvedores podem realizar algumas inicializações antes do processamento de cada solicitação no construtor.

Devido à possibilidade de desativar a reutilização do controlador, o plugin `webman/action-hook` não é mais necessário.

## Inicialização de Serviço HTTP
A versão 1.4 suporta abrir várias portas para fornecer serviços HTTP.
Consulte [Processamento de Tarefas em Segundo Plano](../others/task.md)

## Configuração de Arquivos de Visualização
O sufixo só pode ser configurado na opção `options` em view.php.
**Uso não suportado mais**
```php
use support\view\Raw;
return [
    'handler' => Raw::class,
    'view_suffix' => '.php'
];
```
**Uso correto**
```php
use support\view\Raw;
return [
    'handler' => Raw::class,
    'options' => [
        'view_suffix' => '.php'
    ]
];
```

## Alteração de Namespace do Driver de Sessão
A partir da versão 1.4.0, o namespace da classe `SessionHandler` foi alterado de
```php
use Webman\FileSessionHandler;  
use Webman\RedisSessionHandler;  
use Webman\RedisClusterSessionHandler;  
```
para  
```php
use Webman\Session\FileSessionHandler;  
use Webman\Session\RedisSessionHandler;  
use Webman\Session\RedisClusterSessionHandler;
```

Para evitar erros diretos após a atualização, a classe `Webman\FileSessionHandler` ainda está mantida por um tempo, mas será removida completamente em futuras versões.

Essa alteração afeta a configuração `'handler'` em `config/session.php`.
