# தனி செயலி

வெப்மேனில் நீங்கள் வேலைவாய்ப்பாளரைப் பிணைய அல்லது செயலுக்குரிய செயற்பாடுகளை தயாரிக்கலாம்.

> ** குறிப்பு **
> விண்டோஸ் பயனாளர்கள் `php windows.php` ஐப் பயன்படுத்தி வெப்மேனைத் தொடங்கலாம்.

## தனி ஹெட்டப் சேவை
சில நேரங்களில், உங்களுக்கு ஒரு சிறந்த வேலைக்காரிய தேவையும், வெப்மேன் ஹெட்டப் சேவையின் பானா தொகுப்பை மாற்ற வேண்டியுள்ளது, இதைத் தனி செயலியாகச் செயல்படுத்தலாம்.

உதாரணமாக, புதிய app\Server.php ஐஉருவாக்கவும்

```php
<?php

namespace app;

use Webman\App;

class Server extends App
{
    // இங்கே Webman\App இன் முதலிடத்தை மீண்டத்தியமைக்கவும்
}
```

`config/process.php` இல் பின்வரும் உள்ளடக்கத்தைச் சேர்க்கவும்

```php
use Workerman\Worker;

return [
    // ... இங்கே மற்ற உள்ளடக்கங்களை மறைத்துவிட்டேன்...

    'my-http' => [
        'handler' => app\Server::class,
        'listen' => 'http://0.0.0.0:8686',
        'count' => 8, // செயலி எண்
        'user' => '',
        'group' => '',
        'reusePort' => true,
        'constructor' => [
            'request_class' => \support\Request::class, // request வகை அமைக்கல்
            'logger' => \support\Log::channel('default'), // பதிவு நிலையான உதவி
            'app_path' => app_path(), // app அடைவு இருப்பின் இடம்
            'public_path' => public_path() // பொது அடைவின் இடம்
        ]
    ]
];
```

> **குறிப்பு**
> வெப்மேன் இலவசமாகவே அங்கு http செயலி மூலம் வெப்மேன் வெளியே சென்றவுடன் மூடப்பட விரும்பினால், config/server.php உள்ளே `கேட்டுக்கொள்ளுகவும். `கேள்விப்பட்டுக்கொள்ளப்படாத முறை''


## தனிப்பயனுள்ள websocket உதாரணம் கவனிக்கமுடியும்

புதுப்பிக்க `app/Pusher.php`
```php
<?php
namespace app;

use Workerman\Connection\TcpConnection;

class Pusher
{
    public function onConnect(TcpConnection $connection)
    {
        echo "onConnect\n";
    }

    public function onWebSocketConnect(TcpConnection $connection, $http_buffer)
    {
        echo "onWebSocketConnect\n";
    }

    public function onMessage(TcpConnection $connection, $data)
    {
        $connection->send($data);
    }

    public function onClose(TcpConnection $connection)
    {
        echo "onClose\n";
    }
}
```
> குறிப்பு: அனைத்து onXXX குணங்களும் public பொருள் ஆகும்

`config/process.php`-ல் பின்வரும் அமைப்பைச் சேர்க்கவும்
```php
return [
    //...மற்ற பூரணப்புகள் துவக்கப்படும்...
    
    //websocket_test ஒரு பூரணப்பு பெயர்
    'websocket_test' => [
        // இங்கே பூரணப்பு வகையை குறிப்பிடுக்கின்றது, மேலும் முன்னோட்டு Pusher வகை
        'handler' => app\Pusher::class,
        'listen'  => 'websocket://0.0.0.0:8888',
        'count'   => 1,
    ],
];
```

## தனிப்பயனுள்ள சோதனை பூரணப்பு உதாரணம்
புதுப்பிக்க `app/TaskTest.php`
```php
<?php
namespace app;

use Workerman\Timer;
use support\Db;

class TaskTest
{
  
    public function onWorkerStart()
    {
        // ஒவ்வொரு 10 விநாடிக்கும் பொதுவாக தரவுத் தளத்தில் புதிய பயனர் பதிவிறக்கம் எப்போதும் பரிசீலிக்கப்படும்
        Timer::add(10, function(){
            Db::table('users')->where('regist_timestamp', '>', time()-10)->get();
        });
    }
    
}
```
`config/process.php`-ல் பின்வரும் அமைப்பைச் சேர்க்கவும்
```php
return [
    // ... மற்ற பூரணப்புகள் புறப்படுவதிலிருந்து ...
    
    'task' => [
        'handler'  => app\TaskTest::class
    ],
];
```

> குறிப்பு: listen சுருக்கம் மற்றும் count சுருக்கம் விட முன்னோட்டைத் தரவிறக்கம் செய்யவில்லை.
## கட்டமைப்பு கேள்விகளை விவரிக்கும்

ஒரு செயலி முழு கட்டமைப்பு போன்றவை கட்டமைப்பு எப்போதும் கீழே விவரிக்கப்பட்டுள்ளது:
```php
return [
    // ... 
    
    // உள்வாங்கு_சோதிப்பதின் அட்டை
    'websocket_test' => [
        // இங்கே செயலி வகுப்பு குறியீடு குறிப்பிடுக்கிறது
        'handler' => app\Pusher::class,
        // கேளுகின்ற உரைப்பலகை ஐப் புரிந்து கொள்ளுங்கள் தொடர் ip மற்றும் போதுமான முகவரியைச் செருகவும் புரிந்துகொள்ளுங்கள் (விரும்பினால் தேர்வுசெய்கின்ற வழிமுறை இயக்குபடும்)
        'listen'  => 'websocket://0.0.0.0:8888',
        // செயலி எண் (விரும்பினால், இயல்புநிலையாக 1)
        'count'   => 2,
        // செயலி இயக்கத்திற்கு பயன்படும் பயனர் (விரும்பினால், இயல்புநிலையாக தற்போது பயனர்)
        'user'    => '',
        // செயலி இயக்கத்திற்கு பயன்படும் பயனர் குழு (விரும்பினால், இயல்புநிலையாக தற்போது பயனர் குழு)
        'group'   => '',
        // தற்போதைய செயலியின் மீது reload ஆகும் முடிவு நினைவகமாக இருக்கின்றது (விரும்பினால், இயல்புநிலையாக மொழிபெயர்க்கப்படுகின்றது)
        'reloadable' => true,
        // reusePort ஐ இயலுமைப்படுத்துவதற்கு பயன்படும் அமைப்பாகும் (விரும்பினால், php> 7.0 தவிர்க்கத் தேவை ஆகும் இதன் இயலுமைப்பாகும்)
        'reusePort'  => true,
        // பரிமாற்ற விடக்கும் (விரும்பினால், ssl ஐ இயலுமைப்படுத்த வேண்டும் என்பதை அமைக்க வேண்டும், பொதுவானது tcp ஆகும்)
        'transport'  => 'tcp',
        // மூலம் (தேவைப்படுகின்றது, transport ஓட இருக்கின்றது ssl ஆனது மூலத்தைப் படப்படுத்த வேண்டும்)
        'context'    => [], 
        // செயலி வகுப்பின் உருவாக்கி வாங்கும் யூ. ஐப் பயன்படுத்தி வரைவதன் மூலமாக ஏற்புடைய செயலி வகுப்பின் உருவாக்கி வாங்கும் யூ. ம் மாணவர்கள் வழங்கி வாங்குகின்றன் (விரும்பினால், தேர்வுசெய்கின்ற முறையை வழங்குங்கள்)
        'constructor' => [],
    ],
];
```

## சரிபார்க்கப்பட்டது
வெப்மான் உனக்கு வழிமுறைகளைக் கொண்டுள்ளதும், மேலும் வோர்க்மான் ஆனது தனிப்பட்ட அமைப்பை இடையில் பிரித்துவிடுகின்றது, மேலும் வோர்க்மான் பொருட்பட்டி வழிமுறைகளை `onXXX` அழைப்புகள் ஒரு வரிசையாக உள்ள வழிமுறைகளாக்கல் மூலம் நிரப்புகின்றன, அத்துடன் மற்றும் உபயோக்து பயன்பாட் வேறுபாட்டைத் தாண்டி வோர்க்மானைப் பூரப்படுத்தினால் பிறகு பயன்பாடுகள் பூரப்படுத்தப்படும்.
