# 1.5 আপগ্রেড গাইড

**আপগ্রেড করার আগে ব্যাকআপ নেয়া প্রয়োজন, নিম্নলিখিত কমান্ড দেওয়া ব্যাবস্থা করুন**
`composer require workerman/webman-framework ^1.5 -W && composer require webman/console ^1.2.12 && php webman install`

# বৈশিষ্ট্য এবং পরিবর্তন

workerman v5 [কো-রুটিন](https://www.workerman.net/doc/workerman/fiber.html) সমর্থিত

> **পরামর্শ**
> workerman v5 এর জন্য পিএইচপি>=8.1 প্রয়োজন
> workerman আপগ্রেড কমান্ড `composer require workerman/workerman ^5.0.0 -W`
> ফাইবার কো-রুটিন ইনস্টল করতে হবে `composer require revolt/event-loop ^1.0.0`

# উদাহরণ
### বিলম্বভাবে স্বরলিপি

```php
<?php

namespace app\controller;

use support\Request;
use Workerman\Timer;

class TestController
{
    public function index(Request $request)
    {
        // ১.৫ সেকেন্ড ঘুমান
        Timer::sleep(1.5);
        return $request->getRemoteIp();
    }
}
```
`Timer::sleep()` PHP এর `sleep()` ফাংশনের মতো, দ্রুতি দ্রুতি প্রক্রিয়া অবরুদ্ধ করে না।


### এইচটিটিপি অনুরোধ প্রেরণ

> **লক্ষণীয়**
> ইনস্টল করা প্রয়োজন `composer require workerman/http-client ^2.0.0`

```php
<?php

namespace app\controller;

use support\Request;
use Workerman\Http\Client;

class TestController
{
    public function index(Request $request)
    {
        static $client;
        $client = $client ?: new Client();
        $response = $client->get('http://example.com'); // সিঙ্ক্রোনাস পদ্ধতিতে এইচটিটিপি অনুরোধ প্রেরণ করুন
        return $response->getBody()->getContents();
    }
}
```
একইভাবে, `$client->get()` অনুরোধটি অবরুদ্ধ করা হয়, যা ওয়েবম্যানে অবরুদ্ধ HTTP অনুরোধে ব্যাবহার করা যায়, কার্যক্ষমতা বাড়াতে।

আরও দেখুন [ওয়ার্কাম্যান/এইচটিটিপি-ক্লায়েন্ট](https://www.workerman.net/doc/workerman/components/workerman-http-client.html)

### সাপোর্ট/অবস্থান ক্লাস যোগ

সাপোর্ট/অবস্থান ক্লাসটি রিকোয়েস্ট সম্পর্কিত ডেটা সংরক্ষণ করতে ব্যবহৃত হয়, অনুরোধ শেষ হওয়ার পরে, প্রসঙ্গিক সংদর্ভে, সেই অবস্থা ডেটা স্বয়ংক্রিয়ভাবে মুছে যায়। এটি অর্থাৎ সংদর্ভ-ডেটা জীবনচক্র অনুরূপ।

### গ্লোবাল ভেরিয়েবল মৃদার্শক

কো-রুটিন পরিবেশে পূর্বাধিকার স্থিতি তথ্যগুলি সর্বাধিক ভেরিয়েবল বা স্থিতি ভেরিয়েবলে সংরক্ষণ করা নিষিদ্ধ, কারণ এটা গ্লোবাল ভেরিয়েবল দুষ্টুমিহত হতে পারে যেহেতু এটা সম্পূর্ণ ভেরিয়েবল মিলতে হবে।

```php
<?php

namespace app\controller;

use support\Request;
use Workerman\Timer;

class TestController
{
    protected static $name = '';

    public function index(Request $request)
    {
        static::$name = $request->get('name');
        Timer::sleep(5);
        return static::$name;
    }
}
```

নিরাপদ মেধাবী পদক্ষেপটি হল অনুরোধ অবস্থা ডেটা সংরক্ষণ এর জন্য স্থান ব্যবহার করা।

```php
<?php

namespace app\controller;

use support\Request;
use support\Context;
use Workerman\Timer;

class TestController
{
    public function index(Request $request)
    {
        Context::set('name', $request->get('name'));
        Timer::sleep(5);
        return Context::get('name');
    }
}
```

**স্থানীয় ভেরিয়েবলে উপায়ন কোনো ডাটা দূষণের কারণ হয় না**

```php
<?php

namespace app\controller;

use support\Request;
use support\Context;
use Workerman\Timer;

class TestController
{
    public function index(Request $request)
    {
        $name = $request->get('name');
        Timer::sleep(5);
        return $name;
    }
}
```
কো-রুটিন মধ্যে লোকাল ভেরিয়েবল সন্তুষ্টি বোধ করে কারণ কো-রুটিন মধ্যে একটি লোকাল ভেরিয়েবল একটি অন্য নিন্ম করা হয় না, তাই স্থানীয় ভেরিয়েবল কো-রুটিন প্রসারিত হয়। 

# কো-রুটিন সম্পর্কে
কো-রুটিন এক জন্য একটি রজড় নয়, রিক্তি খালি করার জন্য স্থিতি জানাতে, সহজ রেখার সম্পর্কে চিন্তা করতে হবে। আবার কো-রুটিন পরিবেশে বাগ ডেবাগ করা স্থির পদক্ষেপ থেকে কয়েকটি দুর্বল এককে দেখতে।

ওয়েবম্যান প্রায় প্রতিবন্ধী প্রোগ্রামিংর মাধ্যমে দ্রুতি কার্যক্ষমতা মুখোষ পায়। [techempower.com](https://www.techempower.com/benchmarks/#section=data-r21&l=zijnjz-6bj&test=db&f=1ekg-cbcw-2t4w-27wr68-pc0-iv9slc-0-1ekgw-39g-kxs00-o0zk-4fu13d-2x8do8-2) সামগ্রিক নজর থাকা, গত তিন বছরে তিনটি পর্বের টেস্ট ডেটার মাধ্যমে ওয়েবম্যানে ডেটাবেস কাজের ক্ষেত্রে  জিন এবং উচ্চ পারফরম্যান্স প্রযুক্তি গন বিশেষ্ট্যে  লারাভেল,  ঵িশেষ্ট্যে  এক ডবল কোড থেকে সেই উচ্চ কৰঙা থাকবে  অনুভব করা যায়।
![](../../assets/img/benchemarks-go-sw.png?)

যখন ডেটাবেস, রেডিস ইত্যাদি অন্তর্নিয়েতে, অনেক প্রসেস প্রতিবন্ধী প্রোগ্রামিং কার্যক্ষমতা অধিক হওয়া সম্ভবতঃ কো-রুটিন তুলনামূলকভাবে বৃদ্ধি বাড়ে, এটা কারণ হল ডেটাবেস, রেডিস ইত্যাদি যথেষ্ট দ্রুত হতে, কো-রুটিন তৈরি, উদ্দীপনা, অধিনিত খরচ্যো, প্রয়োজন হতে পারে যেতে পারে প্রসেস পরিবর্তনের খরচ্যো, তাই এই সময়ে কো-রুটিন নিয়ামক পার্শ্বগত গুণও তৈরি করা যায়, এতে গতি বাড়ানোর ব্যাপারে বৃদ্ধি দেখা যায়।

# কো-রুটিন কখন ব্যবহার করবেন
ব্যবসায়ে যদি আবছাজবাণ দরতে হয়, যেমন- ব্যবসায়ে তৃতীয়াংশ ইন্টারনেট প্রোটোকল যেন- [workerman/http-client](https://www.workerman.net/doc/workerman/components/workerman-http-client.html)এর সাথে  ব্যাবহার করা হতে পারে, এটা প্রয়োজন হতে পারে একই অবস্থানে।
